<div class="<%= comment_class(comment) %>" id="comment-<%= comment.id %>">
  
  <%= link_to_learner_avatar(comment.learner, {image_size: :thumb}) %>
  
  <span class="comment_author"><%= link_to_learner(comment.learner) %></span>
  
  <div class='rating_wrapper'>
    <% if current_learner %>
      <% if upvoted_object = current_learner.get_upvoted_object(comment.id, 'Comment') %>
        <span id='undo_vote_comment_<%= comment.id %>'><%= button_to 'Undo vote', rating_path(upvoted_object), :method => :delete, :remote => true, :class => "btn" %></span>
      <% else %>
        <span id="upvote_comment_<%= comment.id %>"><%= button_to '+', ratings_path(:rating => {:rateable_id => comment.id, :rateable_type => 'Comment', :score => 1}), :method => :post, :remote => true, :class => "btn" %></span>
      <% end %>
    <% else %>
      <%= render(partial: '/events/sign_in_to_vote')%>
      <%= button_to '+', {}, {:class => "btn signintovote sitv_element", :disabled => true} %>
      </div> <!-- end .sitv_element_wrapper  -->
    <% end %>
    <div id="comment_votes_<%= comment.id %>" class="rating_detail">
      <%= render :partial => '/partials/ratings', locals: {rateable_object: comment} %>
    </div>
  </div>
  
  <p class="content">
    <%= format_text_for_display(comment.content) %>
  </p>
  
  <span class="comment_time"><span><%= link_to time_ago_in_words(comment.updated_at) + ' ago', comment_path(comment) %> </span>
  <% if current_learner && (current_learner.id == comment.learner_id) %>
    <span class="comment-edit btn btn-link" id="comment-edit-<%= comment.id %>">edit</span>
    <% if parent_comment.present? %>
      <%= link_to 'delete',  comment_path(comment, 
                                       :parent_comment_id => parent_comment.id), 
                                       :method => :delete, 
                                       :confirm => 'Are you sure you want to delete this comment?', 
                                       :remote => true %>
    <% else %>
      <%= link_to 'delete', comment_path(comment), 
                                       :method => :delete, 
                                       :confirm => 'Are you sure you want to delete this comment?', 
                                       :remote => true %>
    <% end %>
  <% end %>
  
  </span>
  
  <% if comment.parent_removed %>
    <p class="removed">The comment preceding this comment has been deleted</p>
  <% end %>
  
  <p class="actions">
  <span class="comment_actions">
    <% if current_learner %>
      <span class="comment-reply btn btn-link pull-left" id="comment-reply-to-comment-<%= comment.id %>">reply</span>
    <% end %>
  </span>
  
  </p>
  <br class="clearing" />
</div>

<div id="comment_template_holder_<%= comment.id %>"></div>

